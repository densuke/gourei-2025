# 号令担当抽選アプリケーション仕様書

## 1. 概要
クラスやグループ内で、特定の役割（例: 号令、日直）を担当する学生をランダムに選出するためのコマンドラインアプリケーション。

## 2. 目的
*   担当者選出の公平性を確保する。
*   選出手順を自動化し、時間と手間を削減する。
*   特定の学生に偏りなく役割が割り当てられる機会を提供する。

## 3. 機能要件
*   **3.1. 学生リストの読み込み:**
    *   アプリケーションは、学生のIDと名前が記載されたCSVファイルを読み込む。
    *   CSVファイルはカンマ区切りで、1行目はヘッダー行 (`id,name`) とする。
    *   **ファイルパス指定:**
        *   `--file` オプション引数でCSVファイルのパスを指定できる。
        *   オプション引数がない場合、コマンドラインの最初の位置引数でファイルパスを指定できる。
        *   オプション引数も位置引数もない場合、デフォルトで実行ディレクトリの `./students.csv` を読み込む。
    *   **デフォルトパス使用時の警告:** デフォルトパス (`./students.csv`) が使用される場合、標準エラー出力に警告メッセージを表示する。
*   **3.2. 抽選:**
    *   読み込んだ学生リストから、重複なくランダムに2名の学生を選出する。
    *   `--seed` オプション引数で乱数生成器のシード値を指定できる（テスト用）。指定がない場合はランダムなシード値を使用する。
*   **3.3. 結果出力:**
    *   選出された2名の学生を「正担当」と「副担当」として、以下の形式で標準出力に表示する。
        ```
        正担当: [ID] [名前]
        副担当: [ID] [名前]
        ```
*   **3.4. エラーハンドリング:**
    *   指定されたCSVファイルが存在しない、または読み込めない場合にエラーメッセージを表示して終了する。
    *   CSVファイルが空、またはヘッダー行しかない場合にエラーメッセージを表示して終了する。
    *   CSVファイルの形式が不正（区切り文字違い、列数不足など）な場合にエラーメッセージを表示して終了する。
    *   学生リストの人数が2名未満の場合にエラーメッセージを表示して終了する。

## 4. 非機能要件
*   **4.1. パフォーマンス:** 学生数が数百人程度のリストであれば、数秒以内に結果を出力すること。
*   **4.2. 信頼性:** 抽選ロジックに偏りがなく、再現性があること（シード値指定時）。エラーハンドリングが適切に行われ、予期せぬ状況でクラッシュしないこと。
*   **4.3. 運用性:** コマンドラインから容易に実行できること。特別な環境設定なしに動作すること（Rustの実行環境は前提とする）。
*   **4.4. 保守性:** コードが整理されており、将来的な機能追加や修正が容易であること。

## 5. データ
*   **入力:** 学生リストCSVファイル
    *   形式: CSV (カンマ区切り)
    *   エンコーディング: UTF-8
    *   ヘッダー: `id,name` (必須)
    *   データ例:
        ```csv
        id,name
        s001,山田 太郎
        s002,佐藤 花子
        s003,鈴木 一郎
        ```
*   **出力:** 標準出力へのテキスト表示
    *   形式:
        ```
        正担当: [ID] [名前]
        副担当: [ID] [名前]
        ```

## 6. その他
*   「正」「副」の割り当てロジック: 最初に選出された学生を「正担当」、次に選出された学生を「副担当」とする。

## 7. テスト要件

本アプリケーションの品質を保証するため、以下のテストを実施する。Rustの標準テストフレームワーク (`#[test]`) を使用し、必要に応じてモックやテスト用のデータファイルを用いる。

*   **7.1. 正常系テスト:**
    *   **抽選結果検証 (固定シード):**
        *   内容: 事前に用意した学生リストのCSVファイルと、固定した乱数生成器のシード値を用いて実行する。
        *   期待結果: 常に同じ2名の学生が、正しい役割（正・副）と正しい出力形式（スペース区切り）で選出されることを確認する。(`rand::rngs::StdRng` と `rand::SeedableRng` の使用を想定)
    *   **コマンドライン引数によるファイル指定:**
        *   内容: テスト用の別名CSVファイルをコマンドライン引数で指定して実行する。
        *   期待結果: 指定されたファイルが読み込まれ、そのリストから抽選が正常に行われ、結果が表示されることを確認する。
    *   **デフォルトファイルパスでの動作:**
        *   内容: コマンドライン引数を指定せずに実行する。事前にデフォルトパス (`./students.csv`) にテスト用CSVファイルを配置しておく。
        *   期待結果: デフォルトパスのファイルが読み込まれ、抽選が正常に行われ、結果が表示されることを確認する。

*   **7.2. 異常系テスト (エラーハンドリング):**
    *   **ファイル不存在:**
        *   内容: 存在しないファイルパスをコマンドライン引数で指定する、またはデフォルトパスにファイルが存在しない状態で引数なしで実行する。
        *   期待結果: プログラムがパニックせず、ファイルが見つからない旨を示す適切なエラーメッセージを表示して終了することを確認する。
    *   **空の学生リスト:**
        *   内容: ヘッダー行のみ、またはデータ行が全くないCSVファイルを読み込ませる。
        *   期待結果: プログラムがパニックせず、リストが空である旨を示す適切なエラーメッセージを表示して終了することを確認する。
    *   **学生数不足 (2名未満):**
        *   内容: 学生が1名しか記載されていないCSVファイルを読み込ませる。
        *   期待結果: プログラムがパニックせず、抽選に必要な人数に満たない旨を示す適切なエラーメッセージを表示して終了することを確認する。
    *   **CSVフォーマット不正:**
        *   内容: 区切り文字がカンマでない、または列数が異なる（IDとNameのペアになっていない）行を含むCSVファイルを読み込ませる。
        *   期待結果: プログラムがパニックせず、CSVの形式が不正である旨を示す適切なエラーメッセージ（`csv` クレート由来のエラーを含む可能性がある）を表示して終了することを確認する。
